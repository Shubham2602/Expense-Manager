{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst tls_1 = require(\"tls\");\n\nconst deferToConnect = (socket, fn) => {\n  let listeners;\n\n  if (typeof fn === 'function') {\n    const connect = fn;\n    listeners = {\n      connect\n    };\n  } else {\n    listeners = fn;\n  }\n\n  const hasConnectListener = typeof listeners.connect === 'function';\n  const hasSecureConnectListener = typeof listeners.secureConnect === 'function';\n  const hasCloseListener = typeof listeners.close === 'function';\n\n  const onConnect = () => {\n    if (hasConnectListener) {\n      listeners.connect();\n    }\n\n    if (socket instanceof tls_1.TLSSocket && hasSecureConnectListener) {\n      if (socket.authorized) {\n        listeners.secureConnect();\n      } else if (!socket.authorizationError) {\n        socket.once('secureConnect', listeners.secureConnect);\n      }\n    }\n\n    if (hasCloseListener) {\n      socket.once('close', listeners.close);\n    }\n  };\n\n  if (socket.writable && !socket.connecting) {\n    onConnect();\n  } else if (socket.connecting) {\n    socket.once('connect', onConnect);\n  } else if (socket.destroyed && hasCloseListener) {\n    listeners.close(socket._hadError);\n  }\n};\n\nexports.default = deferToConnect; // For CommonJS default export support\n\nmodule.exports = deferToConnect;\nmodule.exports.default = deferToConnect;","map":null,"metadata":{},"sourceType":"script"}