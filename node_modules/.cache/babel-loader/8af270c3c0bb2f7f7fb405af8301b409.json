{"ast":null,"code":"const base64url = require('../help/base64url');\n\nconst errors = require('../errors');\n\nmodule.exports = (token, {\n  complete = false\n} = {}) => {\n  if (typeof token !== 'string' || !token) {\n    throw new TypeError('JWT must be a string');\n  }\n\n  const _token$split = token.split('.'),\n        header = _token$split[0],\n        payload = _token$split[1],\n        signature = _token$split[2],\n        length = _token$split.length;\n\n  if (length === 5) {\n    throw new TypeError('JWTs must be decrypted first');\n  }\n\n  if (length !== 3) {\n    throw new errors.JWTMalformed('JWTs must have three components');\n  }\n\n  try {\n    const result = {\n      header: base64url.JSON.decode(header),\n      payload: base64url.JSON.decode(payload),\n      signature\n    };\n    return complete ? result : result.payload;\n  } catch (err) {\n    if (err instanceof errors.JOSEError) {\n      throw err;\n    }\n\n    throw new errors.JWTMalformed('JWT is malformed');\n  }\n};","map":null,"metadata":{},"sourceType":"script"}